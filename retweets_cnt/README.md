# Задача 5. Подсчет количества ретвитов на твиты пользователей

Напишите программу, которая подсчитывает количество ретвитов на твиты каждого пользователя 
в течение 1 мин. с накоплением. Выведите результат в отсортированном по убыванию виде: 
id твита, количество ретвитов. Каждую 1 мин. сохранять результат в файл. 
Накапливать не менее 30 мин. После этого для 5 наиболее популярных твитов вывести: 
screen_name пользователя, id твита и его текст.

Исходные данные:
- id пользователей: "285532415", "147964447", "34200559", "338960856", "200036850", "72525490", "20510157", "99918629"


## Установка zookeeper и kafka

```
brew install zookeeper
brew install kafka
```

## Запуск

1. Запуск zookeeper и kafka
    ```
    zookeeper-server-start /usr/local/etc/kafka/zookeeper.properties
    kafka-server-start /usr/local/etc/kafka/server.properties
    ```
3. Создание kafka topic
    ```
    kafka-topics --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic tweets
    ```
3. Запуск программы
    ```
    python tweets-kafka.py
    spark-submit --jars ../jars/spark-streaming-kafka-0-8-assembly_2.11-2.4.4.jar tweets-spark.py
    ```
    
## Результаты

```

-------------------------------------------
Time: 2019-12-16 04:37:00
-------------------------------------------
('1206284769161613312', {'id': '1206284769161613312', 'screen_name': 'rianru', 'text': '#РИА_Видео\nАндриян Хромов работает таёжным почтальоном в Иркутской области. Мужчина по тайге развозит на санях посылки в глухие деревни. Помимо писем и пенсий, он везёт местным жителям продукты, одежду и батарейки. Для многих почтальон единственная связь с "большой землёй" https://t.co/ZKCJkyTTnl', 'retweet_cnt': 12})
('1206356268807598084', {'id': '1206356268807598084', 'screen_name': 'interfax_news', 'text': 'Джулиани обнародовал отчет о поездке на Украину https://t.co/VuQK78i47O', 'retweet_cnt': 11})
('1206121715580985344', {'id': '1206121715580985344', 'screen_name': 'vesti_news', 'text': 'Мимоза стыдливая - удивительное растение, которое сворачивает листья при прикосновении. https://t.co/HDo2QrKWT3', 'retweet_cnt': 4})
('1206239928243359744', {'id': '1206239928243359744', 'screen_name': 'ntvru', 'text': 'Мамочка в Ханты-Мансийске о чем-то замечталась и растеряла своих детей, пока переходила дорогу. Так и пришла бы домой с пустыми санками, не посигналь ей водитель https://t.co/mT6320ldTK', 'retweet_cnt': 1})
('1206385972008669189', {'id': '1206385972008669189', 'screen_name': 'tass_agency', 'text': 'Посол ЕС в РФ Маркус Эдерер считает, что высылка из Германии двух сотрудников посольства России может повлиять на отношения Москвы и Брюсселя:\nhttps://t.co/NRTpX3AEBl https://t.co/kYRoQFbEuU', 'retweet_cnt': 1})


```
